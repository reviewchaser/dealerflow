  3485→
  3486→      {showAddModal && (
  3487→        <AddVehicleModal onClose={() => setShowAddModal(false)} onSuccess={() => { setShowAddModal(false); fetchVehicles(); }} />
  3488→      )}
  3489→
  3490→      {showAddIssueModal && (
  3491→        <AddIssueModal
  3492→          issueForm={issueForm}
  3493→          setIssueForm={setIssueForm}
  3494→          onClose={() => {
  3495→            setShowAddIssueModal(false);
  3496→            setIssueForm({
  3497→              category: "",
  3498→              subcategory: "",
  3499→              description: "",
  3500→              actionNeeded: "",
  3501→              status: "outstanding",
  3502→              notes: "",
  3503→              photos: [],
  3504→            });
  3505→          }}
  3506→          onSubmit={addIssue}
  3507→        />
  3508→      )}
  3509→
  3510→      {showAddDocumentModal && (
  3511→        <AddDocumentModal
  3512→          documentForm={documentForm}
  3513→          setDocumentForm={setDocumentForm}
  3514→          onClose={() => {
  3515→            setShowAddDocumentModal(false);
  3516→            setDocumentForm({ name: "", type: "other", file: null });
  3517→          }}
  3518→          onSubmit={() => {
  3519→            if (!documentForm.file) {
  3520→              return toast.error("File is required");
  3521→            }
  3522→            if (documentForm.type === "other" && !documentForm.name) {
  3523→              return toast.error("Document name is required for 'Other' type");
  3524→            }
  3525→            // Generate default name based on type if not "other"
  3526→            const docName = documentForm.type === "other"
  3527→              ? documentForm.name
  3528→              : documentForm.type.replace(/_/g, " ").replace(/\b\w/g, l => l.toUpperCase());
  3529→            uploadDocument(documentForm.file, docName, documentForm.type);
  3530→          }}
  3531→        />
  3532→      )}
  3533→
  3534→      {showAddLocationModal && (
  3535→        <AddLocationModal
  3536→          onClose={() => setShowAddLocationModal(false)}
  3537→          onSuccess={(newLocation) => {
  3538→            setLocations([...locations, newLocation]);
  3539→            setSelectedVehicle({ ...selectedVehicle, locationId: newLocation.id || newLocation._id });
  3540→            fetch(`/api/vehicles/${selectedVehicle.id}`, {
  3541→              method: "PUT",
  3542→              headers: { "Content-Type": "application/json" },
  3543→              body: JSON.stringify({ locationId: newLocation.id || newLocation._id }),
  3544→            }).then(() => {
  3545→              fetchVehicles();
  3546→              setShowAddLocationModal(false);
  3547→            });
  3548→          }}
  3549→        />
  3550→      )}
  3551→
  3552→      {/* Parts Order Modal */}
  3553→      {showPartsOrderModal && (
  3554→        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
  3555→          <div className="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4">
  3556→            <div className="flex items-center justify-between p-4 border-b border-slate-200">
  3557→              <h3 className="text-lg font-bold text-slate-900">
  3558→                {editingPartsOrderId ? "Edit Parts Order" : "Add Parts Order"}
  3559→              </h3>
  3560→              <button
  3561→                onClick={closePartsOrderModal}
  3562→                className="btn btn-ghost btn-sm btn-circle"
  3563→              >
  3564→                ✕
  3565→              </button>
  3566→            </div>
  3567→            <div className="p-4 space-y-4">
  3568→              <div className="form-control">
  3569→                <label className="label">
  3570→                  <span className="label-text font-medium">Supplier</span>
  3571→                </label>
  3572→                <select
  3573→                  className="select select-bordered w-full"
  3574→                  value={partsOrderForm.supplierType}
  3575→                  onChange={(e) => setPartsOrderForm({ ...partsOrderForm, supplierType: e.target.value })}
  3576→                >
  3577→                  <option value="EURO_CAR_PARTS">Euro Car Parts</option>
  3578→                  <option value="TPS">TPS</option>
  3579→                  <option value="MAIN_DEALER">Main Dealer</option>
  3580→                  <option value="LOCAL_FACTOR">Local Factor</option>
  3581→                  <option value="ONLINE">Online</option>
  3582→                  <option value="OTHER">Other</option>
  3583→                </select>
  3584→              </div>
  3585→              {partsOrderForm.supplierType === "OTHER" && (
  3586→                <div className="form-control">
  3587→                  <label className="label">
  3588→                    <span className="label-text font-medium">Supplier Name</span>
  3589→                  </label>
  3590→                  <input
  3591→                    type="text"
  3592→                    placeholder="Enter supplier name"
  3593→                    className="input input-bordered w-full"
  3594→                    value={partsOrderForm.supplierName}
  3595→                    onChange={(e) => setPartsOrderForm({ ...partsOrderForm, supplierName: e.target.value })}
  3596→                  />
  3597→                </div>
  3598→              )}
  3599→              <div className="form-control">
  3600→                <label className="label">
  3601→                  <span className="label-text font-medium">Order Reference (Optional)</span>
  3602→                </label>
  3603→                <input
  3604→                  type="text"
  3605→                  placeholder="e.g., ORD-123456"
  3606→                  className="input input-bordered w-full"
  3607→                  value={partsOrderForm.orderRef}
  3608→                  onChange={(e) => setPartsOrderForm({ ...partsOrderForm, orderRef: e.target.value })}
  3609→                />
  3610→              </div>
  3611→              <div className="form-control">
  3612→                <label className="label">
  3613→                  <span className="label-text font-medium">Expected Delivery (Optional)</span>
  3614→                </label>
  3615→                <input
  3616→                  type="date"
  3617→                  className="input input-bordered w-full"
  3618→                  value={partsOrderForm.expectedAt}
  3619→                  onChange={(e) => setPartsOrderForm({ ...partsOrderForm, expectedAt: e.target.value })}
  3620→                />
  3621→              </div>
  3622→              <div className="form-control">
  3623→                <label className="label">
  3624→                  <span className="label-text font-medium">Notes (Optional)</span>
  3625→                </label>
  3626→                <input
  3627→                  type="text"
  3628→                  placeholder="e.g., Oil filter + air filter"
  3629→                  className="input input-bordered w-full"
  3630→                  value={partsOrderForm.notes}
  3631→                  onChange={(e) => setPartsOrderForm({ ...partsOrderForm, notes: e.target.value })}
  3632→                />
  3633→              </div>
  3634→            </div>
  3635→            <div className="flex justify-end gap-2 p-4 border-t border-slate-200">
  3636→              <button
  3637→                className="btn btn-ghost"
  3638→                onClick={closePartsOrderModal}
  3639→              >
  3640→                Cancel
  3641→              </button>
  3642→              <button
  3643→                className="btn btn-primary"
  3644→                onClick={editingPartsOrderId ? updatePartsOrder : addPartsOrder}
  3645→              >
  3646→                {editingPartsOrderId ? "Update" : "Add Order"}
  3647→              </button>
  3648→            </div>
  3649→          </div>
  3650→        </div>
  3651→      )}
  3652→
  3653→      {/* Add Label Modal */}
  3654→      {showAddLabelModal && (
  3655→        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
  3656→          <div className="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4">
  3657→            <div className="flex items-center justify-between p-4 border-b border-slate-200">
  3658→              <h3 className="text-lg font-bold text-slate-900">Create New Label</h3>
  3659→              <button
  3660→                onClick={() => {
  3661→                  setShowAddLabelModal(false);
  3662→                  setNewLabelForm({ name: "", colour: "#6366f1" });
  3663→                }}
  3664→                className="btn btn-ghost btn-sm btn-circle"
  3665→              >
  3666→                ✕
  3667→              </button>
  3668→            </div>
  3669→            <div className="p-4 space-y-4">
  3670→              <div className="form-control">
  3671→                <label className="label">
  3672→                  <span className="label-text font-medium">Label Name</span>
  3673→                </label>
  3674→                <input
  3675→                  type="text"
  3676→                  placeholder="e.g., Hot Lead, Awaiting Finance"
  3677→                  className="input input-bordered w-full"
  3678→                  value={newLabelForm.name}
  3679→                  onChange={(e) => setNewLabelForm({ ...newLabelForm, name: e.target.value })}
  3680→                  autoFocus
  3681→                />
  3682→              </div>
  3683→              <div className="form-control">
  3684→                <label className="label">

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
