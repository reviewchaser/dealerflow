  1980→                  </BottomSheet>
  1981→            </div>
  1982→          </div>
  1983→      </div>
  1984→
  1985→      {isLoading ? (
  1986→        <div className="flex justify-center py-20">
  1987→          <span className="loading loading-spinner loading-lg"></span>
  1988→        </div>
  1989→      ) : (
  1990→        <>
  1991→          {/* Mobile Column Tabs - Dropdown for clearer UX */}
  1992→          <div className="md:hidden mb-4">
  1993→            <MobileStageSelector
  1994→              stages={COLUMNS.map((col) => ({
  1995→                value: col.key,
  1996→                label: col.label,
  1997→                count: getVehiclesByStatus(col.key).length,
  1998→              }))}
  1999→              activeStage={mobileActiveColumn}
  2000→              onStageChange={setMobileActiveColumn}
  2001→            />
  2002→          </div>
  2003→
  2004→          {/* Mobile Single Column View */}
  2005→          <div className="md:hidden">
  2006→            {COLUMNS.filter(col => col.key === mobileActiveColumn).map((col) => {
  2007→              const columnVehicles = getVehiclesByStatus(col.key);
  2008→
  2009→              // Issue category styling with icons (mobile)
  2010→              const issueCategoryStyles = {
  2011→                Mechanical: { bg: "bg-red-50", text: "text-red-700", border: "border-red-100", icon: (
  2012→                  <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2013→                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
  2014→                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
  2015→                  </svg>
  2016→                )},
  2017→                Cosmetic: { bg: "bg-teal-50", text: "text-teal-700", border: "border-teal-100", icon: (
  2018→                  <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2019→                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" />
  2020→                  </svg>
  2021→                )},
  2022→                Electrical: { bg: "bg-yellow-50", text: "text-yellow-800", border: "border-yellow-100", icon: (
  2023→                  <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2024→                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
  2025→                  </svg>
  2026→                )},
  2027→                Other: { bg: "bg-blue-50", text: "text-blue-700", border: "border-blue-100", icon: (
  2028→                  <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2029→                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
  2030→                  </svg>
  2031→                )},
  2032→              };
  2033→
  2034→              return (
  2035→                <div key={col.key} className="space-y-3">
  2036→                  {columnVehicles.map((vehicle) => {
  2037→                    const tasks = vehicle.tasks || [];
  2038→                    const completedTasks = tasks.filter(t => t.status === "done").length;
  2039→                    const motStatus = getMOTStatus(vehicle.motExpiryDate);
  2040→                    const issueCounts = getActiveIssuesByCategory(vehicle.issues);
  2041→                    const duration = getVehicleDuration(vehicle);
  2042→
  2043→                    return (
  2044→                      <div
  2045→                        key={vehicle.id}
  2046→                        className="bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow border border-slate-100/50 overflow-hidden active:scale-[0.98]"
  2047→                        onClick={() => openVehicleDrawer(vehicle)}
  2048→                      >
  2049→                        <div className="p-4">
  2050→                          {/* Title with Registration Badge */}
  2051→                          <div className="flex justify-between items-start mb-2">
  2052→                            <div className="flex-1">
  2053→                              <div className="flex items-center gap-2 flex-wrap mb-1">
  2054→                                <p className="font-bold text-slate-900 text-base">
  2055→                                  {vehicle.year || ""} {vehicle.make} {vehicle.model}
  2056→                                </p>
  2057→                                <span className="font-mono text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded-md">
  2058→                                  {vehicle.regCurrent}
  2059→                                </span>
  2060→                              </div>
  2061→                            </div>
  2062→                            {/* Duration badge - Sold or In Stock */}
  2063→                            <span className={`inline-flex items-center gap-1 text-xs ${
  2064→                              duration.isSold ? "text-emerald-600" : duration.days > 30 ? "text-red-500" : "text-slate-400"
  2065→                            }`}>
  2066→                              <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2067→                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
  2068→                              </svg>
  2069→                              {duration.label}
  2070→                            </span>
  2071→                          </div>
  2072→
  2073→                          {/* Tags - Modern Pill Style */}
  2074→                          <div className="flex gap-1.5 flex-wrap mb-3">
  2075→                            {vehicle.locationId && (
  2076→                              <span className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-semibold bg-[#0066CC]/10 text-[#0066CC] border border-[#0066CC]/20">
  2077→                                <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2078→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
  2079→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
  2080→                                </svg>
  2081→                                {vehicle.locationId.name || "Offsite"}
  2082→                              </span>
  2083→                            )}
  2084→                            {vehicle.saleType === "TRADE" && (
  2085→                              <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-bold bg-slate-800 text-white uppercase">
  2086→                                Trade
  2087→                              </span>
  2088→                            )}
  2089→                            {vehicle.type === "COURTESY" && (
  2090→                              <span className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-bold bg-cyan-600 text-white uppercase">
  2091→                                <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2092→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
  2093→                                </svg>
  2094→                                Courtesy
  2095→                              </span>
  2096→                            )}
  2097→                            {vehicle.type === "FLEET_OTHER" && (
  2098→                              <span className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-bold bg-[#0066CC] text-white uppercase">
  2099→                                <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2100→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
  2101→                                </svg>
  2102→                                Fleet
  2103→                              </span>
  2104→                            )}
  2105→                            {motStatus?.type === "expired" && (
  2106→                              <span className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-semibold bg-red-50 text-red-700 border border-red-100">
  2107→                                <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2108→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
  2109→                                </svg>
  2110→                                MOT {motStatus.label}
  2111→                              </span>
  2112→                            )}
  2113→                            {motStatus?.type === "due_soon" && (
  2114→                              <span className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-semibold bg-amber-50 text-amber-700 border border-amber-100">
  2115→                                <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2116→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
  2117→                                </svg>
  2118→                                MOT {motStatus.label}
  2119→                              </span>
  2120→                            )}
  2121→                            {motStatus?.type === "valid" && (
  2122→                              <span className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-semibold bg-emerald-50 text-emerald-700 border border-emerald-100">
  2123→                                <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2124→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
  2125→                                </svg>
  2126→                                MOT {vehicle.motExpiryDate ? new Date(vehicle.motExpiryDate).toLocaleDateString('en-GB', { day: 'numeric', month: 'short' }) : motStatus.label}
  2127→                              </span>
  2128→                            )}
  2129→                            {motStatus?.type === "unknown" && (
  2130→                              <span className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-semibold bg-slate-100 text-slate-500 border border-slate-200">
  2131→                                <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2132→                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
  2133→                                </svg>
  2134→                                MOT ?
  2135→                              </span>
  2136→                            )}
  2137→                            {/* Issue Pills with Icons */}
  2138→                            {Object.entries(issueCounts).map(([category, count]) => {
  2139→                              const style = issueCategoryStyles[category] || issueCategoryStyles.Other;
  2140→                              return (
  2141→                                <span key={category} className={`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-semibold ${style.bg} ${style.text} border ${style.border}`}>
  2142→                                  {style.icon}
  2143→                                  {count} {category}
  2144→                                </span>
  2145→                              );
  2146→                            })}
  2147→                            {/* Custom Labels */}
  2148→                            {vehicle.labels?.map((label) => (
  2149→                              <span
  2150→                                key={label.id}
  2151→                                className="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-semibold border"
  2152→                                style={{
  2153→                                  backgroundColor: `${label.colour}10`,
  2154→                                  color: label.colour,
  2155→                                  borderColor: `${label.colour}30`,
  2156→                                }}
  2157→                              >
  2158→                                <span className="w-1.5 h-1.5 rounded-full" style={{ backgroundColor: label.colour }}></span>
  2159→                                {label.name}
  2160→                              </span>
  2161→                            ))}
  2162→                          </div>
  2163→
  2164→                          {/* Slick Progress Bar */}
  2165→                          {tasks.length > 0 && (
  2166→                            <div>
  2167→                              <span className="text-xs text-slate-400 mb-1 block">
  2168→                                {completedTasks}/{tasks.length} tasks
  2169→                              </span>
  2170→                              <div className="w-full bg-slate-100 rounded-full h-2">
  2171→                                <div
  2172→                                  className="h-2 rounded-full transition-all bg-gradient-to-r from-blue-500 to-cyan-400"
  2173→                                  style={{ width: `${(completedTasks / tasks.length) * 100}%` }}
  2174→                                ></div>
  2175→                              </div>
  2176→                            </div>
  2177→                          )}
  2178→                        </div>
  2179→                      </div>

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
