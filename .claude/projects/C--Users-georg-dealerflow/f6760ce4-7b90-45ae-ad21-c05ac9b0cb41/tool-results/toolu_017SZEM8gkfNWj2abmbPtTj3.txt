     1→/**
     2→ * BottomSheet Component - Mobile-friendly modal that slides up from bottom
     3→ *
     4→ * IMPORTANT: Uses Portal to render outside DOM hierarchy, ensuring fixed
     5→ * positioning works correctly regardless of parent CSS (transform, filter, etc.)
     6→ *
     7→ * Usage:
     8→ *   <BottomSheet isOpen={isOpen} onClose={() => setIsOpen(false)} title="Filters">
     9→ *     <FilterContent />
    10→ *   </BottomSheet>
    11→ */
    12→
    13→import { useEffect, useRef } from "react";
    14→import { Portal } from "./Portal";
    15→
    16→export function BottomSheet({
    17→  isOpen,
    18→  onClose,
    19→  title,
    20→  children,
    21→  footer,
    22→  maxHeight = "85vh",
    23→  className = "",
    24→  hideAbove = "md", // "md" = hide above 768px, "lg" = hide above 1024px
    25→}) {
    26→  const sheetRef = useRef(null);
    27→
    28→  // Lock body scroll when open
    29→  useEffect(() => {
    30→    if (isOpen) {
    31→      // Store current scroll position and lock
    32→      const scrollY = window.scrollY;
    33→      document.body.style.position = "fixed";
    34→      document.body.style.top = `-${scrollY}px`;
    35→      document.body.style.left = "0";
    36→      document.body.style.right = "0";
    37→      document.body.style.overflow = "hidden";
    38→
    39→      return () => {
    40→        // Restore scroll position
    41→        document.body.style.position = "";
    42→        document.body.style.top = "";
    43→        document.body.style.left = "";
    44→        document.body.style.right = "";
    45→        document.body.style.overflow = "";
    46→        window.scrollTo(0, scrollY);
    47→      };
    48→    }
    49→  }, [isOpen]);
    50→
    51→  // Handle escape key
    52→  useEffect(() => {
    53→    const handleEscape = (e) => {
    54→      if (e.key === "Escape" && isOpen) {
    55→        onClose();
    56→      }
    57→    };
    58→    window.addEventListener("keydown", handleEscape);
    59→    return () => window.removeEventListener("keydown", handleEscape);
    60→  }, [isOpen, onClose]);
    61→
    62→  if (!isOpen) return null;
    63→
    64→  // Determine which breakpoint to hide at
    65→  const hideClass = hideAbove === "lg" ? "lg:hidden" : "md:hidden";
    66→
    67→  return (
    68→    <Portal>
    69→      <div className={`fixed inset-0 z-[9999] ${hideClass}`}>
    70→        {/* Backdrop */}
    71→        <div
    72→          className="fixed inset-0 bg-black/50 backdrop-blur-sm"
    73→          onClick={onClose}
    74→          aria-hidden="true"
    75→        />
    76→
    77→        {/* Sheet - Fixed to viewport bottom */}
    78→        <div
    79→          ref={sheetRef}
    80→          role="dialog"
    81→          aria-modal="true"
    82→          aria-labelledby="bottom-sheet-title"
    83→          className={`fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl flex flex-col animate-slide-up ${className}`}
    84→          style={{ maxHeight }}
    85→        >
    86→          {/* Handle */}
    87→          <div className="flex justify-center pt-3 pb-1 shrink-0">
    88→            <div className="w-10 h-1 bg-slate-300 rounded-full" />
    89→          </div>
    90→
    91→          {/* Header - Sticky */}
    92→          <div className="flex items-center justify-between px-4 py-3 border-b border-slate-200 bg-white shrink-0">
    93→            <h2 id="bottom-sheet-title" className="text-lg font-bold text-slate-900">{title}</h2>
    94→            <button
    95→              onClick={onClose}
    96→              className="p-2 -mr-2 rounded-lg text-slate-400 hover:text-slate-600 hover:bg-slate-100 transition-colors"
    97→              aria-label="Close"
    98→            >
    99→              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
   100→                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
   101→              </svg>
   102→            </button>
   103→          </div>
   104→
   105→          {/* Content - Scrollable */}
   106→          <div className="flex-1 overflow-y-auto overscroll-contain p-4 min-h-0">
   107→            {children}
   108→          </div>
   109→
   110→          {/* Footer - Sticky at bottom */}
   111→          {footer && (
   112→            <div
   113→              className="shrink-0 border-t border-slate-200 bg-white p-4"
   114→              style={{ paddingBottom: "max(1rem, env(safe-area-inset-bottom))" }}
   115→            >
   116→              {footer}
   117→            </div>
   118→          )}
   119→        </div>
   120→
   121→        <style jsx global>{`
   122→          @keyframes slide-up {
   123→            from {
   124→              transform: translateY(100%);
   125→            }
   126→            to {
   127→              transform: translateY(0);
   128→            }
   129→          }
   130→          .animate-slide-up {
   131→            animation: slide-up 0.3s ease-out forwards;
   132→          }
   133→        `}</style>
   134→      </div>
   135→    </Portal>
   136→  );
   137→}
   138→
   139→export default BottomSheet;
   140→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
