  2000→                  </div>
  2001→                  <p className="text-sm text-slate-500">
  2002→                    Click "Generate AI Review" to get AI-powered analysis of this case.
  2003→                  </p>
  2004→                </div>
  2005→              )}
  2006→
  2007→              {/* AI Diagnostics Panel */}
  2008→              <div className="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
  2009→                <div className="px-4 py-3 border-b border-slate-100 flex items-center justify-between">
  2010→                  <h3 className="text-sm font-semibold text-slate-900">AI Diagnostics</h3>
  2011→                  <button
  2012→                    className="inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-md transition-colors"
  2013→                    onClick={fetchAIDiagnostics}
  2014→                    disabled={isLoadingDiagnostics}
  2015→                  >
  2016→                    {isLoadingDiagnostics ? (
  2017→                      <span className="w-3.5 h-3.5 border-2 border-slate-300 border-t-slate-600 rounded-full animate-spin"></span>
  2018→                    ) : aiDiagnostics ? (
  2019→                      <>
  2020→                        <svg className="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2021→                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
  2022→                        </svg>
  2023→                        Refresh
  2024→                      </>
  2025→                    ) : (
  2026→                      <>
  2027→                        <svg className="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  2028→                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
  2029→                        </svg>
  2030→                        Get Suggestions
  2031→                      </>
  2032→                    )}
  2033→                  </button>
  2034→                </div>
  2035→                {(aiDiagnostics || isLoadingDiagnostics) && (
  2036→                  <AISuggestionsPanel
  2037→                    suggestions={aiDiagnostics?.suggestions}
  2038→                    isLoading={isLoadingDiagnostics}
  2039→                    isDummy={aiDiagnostics?.isDummy}
  2040→                    onCopyToNotes={(text) => {
  2041→                      setNewComment((prev) => prev ? prev + "\n\n" + text : text);
  2042→                      toast.success("Added to comment draft");
  2043→                    }}
  2044→                  />
  2045→                )}
  2046→              </div>
  2047→
  2048→              {/* Issue Summary */}
  2049→              {selectedCase.summary && (
  2050→                <div className="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
  2051→                  <div className="px-4 py-3 border-b border-slate-100">
  2052→                    <h3 className="text-sm font-semibold text-slate-900">Issue Summary</h3>
  2053→                  </div>
  2054→                  <div className="p-4">
  2055→                    <p className="text-sm text-slate-700 whitespace-pre-wrap">{selectedCase.summary}</p>
  2056→                  </div>
  2057→                </div>
  2058→              )}
  2059→
  2060→              {/* Timeline */}
  2061→              <div className="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
  2062→                <div className="px-4 py-3 border-b border-slate-100">
  2063→                  <h3 className="text-sm font-semibold text-slate-900">Timeline</h3>
  2064→                </div>
  2065→                <div className="p-4">
  2066→                  {/* Event-driven timeline (newest first) with grouping */}
  2067→                  <div className="space-y-3 mb-4">
  2068→                    {groupTimelineEvents(selectedCase.events || []).map((item, idx) => {
  2069→                      // Handle grouped STATUS_CHANGED events
  2070→                      if (item.isGroup && item.type === "STATUS_CHANGED_GROUP") {
  2071→                        const isExpanded = expandedTimelineGroups[idx];
  2072→                        const lastEvent = item.events[0]; // Most recent in group
  2073→
  2074→                        // If only one event in group, render normally
  2075→                        if (item.events.length === 1) {
  2076→                          const event = item.events[0];
  2077→                          return (
  2078→                            <div key={idx} className="flex gap-3 items-start opacity-70">
  2079→                              <div className="text-base text-slate-400" title={event.type}>
  2080→                                {EVENT_ICONS.STATUS_CHANGED}
  2081→                              </div>
  2082→                              <div className="flex-1 min-w-0">
  2083→                                <p className="text-xs text-slate-500">{event.summary || "Status changed"}</p>
  2084→                                <p className="text-xs text-slate-400" title={new Date(event.createdAt).toLocaleString()}>
  2085→                                  {relativeTime(event.createdAt)}
  2086→                                  {event.createdByName && <span className="ml-1">by {event.createdByName}</span>}
  2087→                                </p>
  2088→                              </div>
  2089→                            </div>
  2090→                          );
  2091→                        }
  2092→
  2093→                        return (
  2094→                          <div key={idx} className="border border-slate-200 rounded-lg p-2 bg-slate-50/50">
  2095→                            <button
  2096→                              className="flex gap-3 items-start w-full text-left"
  2097→                              onClick={() => setExpandedTimelineGroups(prev => ({ ...prev, [idx]: !prev[idx] }))}
  2098→                            >
  2099→                              <div className="text-base text-slate-400" title="Multiple status changes">

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
